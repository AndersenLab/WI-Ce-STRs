mrt_trait <- data.table::fread("/Users/gaotian/Downloads/Table S MS 20220810.csv") %>%
dplyr::select(isotype,mean_Mrt)
View(mrt_trait)
mrt_trait <- data.table::fread("/Users/gaotian/Downloads/Table S MS 20220810.csv") %>%
dplyr::select(isotype,mean_Mrt) %>%
dplyr::rename(strain=isotype)
write.table(mrt_trait, paste("~/OneDrive - Northwestern University/temp_file_fig/mrt_trait.tsv",sep = ""), sep = "\t", row.names = F, quote = FALSE)
View(mrt_trait)
mrt_trait <- data.table::fread("/Users/gaotian/Downloads/Table S MS 20220810.csv") %>%
dplyr::select(scored_strain,mean_Mrt) %>%
dplyr::rename(strain=scored_strain)
View(mrt_trait)
mrt_trait <- data.table::fread("/Users/gaotian/Downloads/Table S MS 20220810.csv") %>%
dplyr::select(scored_strain,mean_Mrt) %>%
dplyr::rename(strain=scored_strain)
write.table(mrt_trait, paste("~/OneDrive - Northwestern University/temp_file_fig/mrt_trait.tsv",sep = ""), sep = "\t", row.names = F, quote = FALSE)
#####.
#### 2022_09_13 #####
Supplemental_Table_S07 <- data.table::fread("/Users/gaotian/OneDrive - Northwestern University/projects/manuscripts/eQTL/raw_data/Laricchia2017/Supplemental_Tables/Supplemental_Table_S07.txt")
View(Supplemental_Table_S07)
strain_lari <- Supplemental_Table_S07 %>%
tidyr::gather(strain,value,-Trait)
library(tidyverse)
strain_lari <- Supplemental_Table_S07 %>%
tidyr::gather(strain,value,-Trait)
View(strain_lari)
strain_lari <- Supplemental_Table_S07 %>%
tidyr::gather(strain,value,-Trait) %>%
dplyr::distinct(strain)
View(strain_lari)
strain_lari <- Supplemental_Table_S07 %>%
tidyr::gather(isotype,value,-Trait) %>%
dplyr::distinct(isotype)
View(strain_lari)
iso_ref <- read.delim("~/OneDrive - Northwestern University/GenomicData/iso_ref_20220106.tsv")
strain_lari <- Supplemental_Table_S07 %>%
tidyr::gather(isotype,value,-Trait) %>%
dplyr::distinct(isotype) %>%
dplyr::left_join(iso_ref)
View(strain_lari)
strain_lari <- Supplemental_Table_S07 %>%
tidyr::gather(isotype,value,-Trait) %>%
dplyr::distinct(isotype) %>%
dplyr::filter(isotype %in% iso_ref$isotype)
View(strain_lari)
lgmtpm <- data.table::fread("/Users/gaotian/OneDrive - Northwestern University/projects/manuscripts/eQTL/raw_data/Filtering_normalization/all561_mp_tx_fddiv_gwas.tsv")
View(lgmtpm)
strain_lari <- Supplemental_Table_S07 %>%
tidyr::gather(isotype,value,-Trait) %>%
dplyr::distinct(isotype) %>%
dplyr::filter(isotype %in% iso_ref$isotype)%>%
dplyr::filter(isotype %in% lgmtpm$strain)
View(strain_lari)
View(Supplemental_Table_S07)
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/"))
### load R packages####
library(tidyverse)
### ggplot theme ####
theme_cust <- theme_bw() +
theme(plot.title = ggplot2::element_text(size=10,  color = "black"),
legend.text = ggplot2::element_text(size=10,  color = "black"),
legend.title =  ggplot2::element_text(size=10,  color = "black"),
axis.title =  ggplot2::element_text(size=10,  color = "black"),
axis.text =  ggplot2::element_text(size=10,  color = "black"),
strip.text = ggplot2::element_text(size=10, vjust = 1,  color = "black"),
strip.background = ggplot2::element_blank(),
panel.grid = ggplot2::element_blank(),
text = ggplot2::element_text(family="Helvetica"))
ancestry.colours <- c("gold2","plum4", "darkorange1",   "lightskyblue2",
"springgreen4", "lightpink2",  "deepskyblue4",
"yellow3",  "yellow4",
'black','red2', 'cornflowerblue', 'magenta', 'darkolivegreen4',
'indianred1', 'tan4', 'darkblue', 'yellowgreen', "tan1",
'darkgray', 'wheat4', '#DDAD4B', 'chartreuse','seagreen1',
'moccasin', 'mediumvioletred', 'cadetblue1',"darkolivegreen1" ,"#7CE3D8",
"gainsboro","#E69F00","#009E73", "#F0E442", "sienna4", "#0072B2",
"mediumpurple4","#D55E00", "burlywood3","gray51","#CC79A7","gray19", "firebrick")
period_size_color <- c("1"="gold2","2"="plum4","3"="darkorange1",
"4"= "lightskyblue2","5" = "springgreen4", "6" = "lightpink2" )
#### func ####
fisher_enrich_func <- function(pt_deg){
sis <- pt_deg$sig_n
silp <- pt_deg$n - sis
fis <- pt_deg$sig_total - sis
filp <- pt_deg$total - pt_deg$sig_total - silp
ftp <- fisher.test(matrix(c(sis,silp,fis,filp), 2, 2), alternative='greater')
return(ftp$p.value)
}
############# Figure  1    ###############
#          pSTR distribution             #
##########################################
table_s1 <- data.table::fread("../processed_data/table_s1_refSTRs_pSTRs.txt")
table_s1_poly <- table_s1 %>%
dplyr::filter(pSTRs=="Yes")
###### fig_2a ######
bp_diff_BPD <- table_s1_poly %>%
dplyr::select(ref_STR,Chr,start,BPDIFFS) %>%
dplyr::arrange(Chr,start) %>%
splitstackshape::cSplit("BPDIFFS",",", direction = "long",sep = ",")
fig_2a <- ggplot(bp_diff_BPD,aes(BPDIFFS))   +
geom_histogram(color="black", fill="white",bins =80,size=0.2) +
theme_cust +
ylab("Number of\nalleles") +
xlab("Base-pair difference")
###### fig_2b ######
expansion_contractionS <- table_s1_poly %>%
dplyr::select(ref_STR ,expansion_score,contraction_score,motif_length) %>%
tidyr::gather(diff,score,-ref_STR,-motif_length) %>%
dplyr::filter(!score==0) %>%
dplyr::ungroup() %>%
dplyr::group_by(diff,motif_length) %>%
dplyr::mutate(lg_sc=log10(abs(score))) %>%
dplyr::mutate(mean_lg_sc=mean(lg_sc),
mean_sc=mean(score),
median_sc=median(score)) %>%
dplyr::mutate(id=row_number(),
mean_lg_sc=ifelse(id==1,round(mean_lg_sc,digits = 2),NA))
fig_2b <- ggplot(expansion_contractionS ,aes(score,fill=diff)) +
geom_histogram(color="black",
bins =100,size=0.2) +
theme_cust +
xlab("Contraction / Expansion score")+
ylab("Number of\nSTRs")   +
scale_fill_manual(values=c("#E7B800", "#00AFBB")) +
theme( legend.position = "none")
###### fig_2c ######
motif_length.labs <- c("Mono-STR", "Di-STR","Tri-STR","Tetra-STR","Penta-STR","Hexa-STR")
names(motif_length.labs) <- c("1", "2", "3", "4", "5", "6")
fig_2c <- ggplot(expansion_contractionS,aes(x=diff,y=lg_sc ,color=diff))+
geom_violin(width=1.1,size=0.2)+
geom_boxplot(width=0.08, color="black",fill="grey", alpha=0.2,outlier.shape = NA,size=0.2) +
geom_point(aes(x=diff,y=mean_lg_sc),size=0.5,color="red") +
theme_cust +
ylab("Contraction /\nExpansion\ntransformed scores") +
ggpubr::stat_compare_means(  label = "p.signif", method = "wilcox.test",
label.x=1.35,
symnum.args = list(cutpoints = c(0, 0.00001, 0.0001, 0.001,  1),
symbols = c("****","***","**",  "ns")) ,
label.y = 0.2) +
facet_grid(.~motif_length,scales="free",
labeller = labeller(motif_length = motif_length.labs)) +
scale_color_manual(values=c("#E7B800", "#00AFBB")) +
theme(axis.text.x = element_blank(),axis.title.x = element_blank(),
legend.position = "none")  +
scale_y_continuous(expand = c(0, 0), limits = c(-2, 0.5))
###### fig_2d ######
expand_frac <- table_s1_poly %>%
dplyr::select(ref_STR ,Contraction_frac,Expansion_frac,motif_length) %>%
tidyr::gather(diff,frac,-ref_STR,-motif_length) %>%
dplyr::mutate(frac=frac/100) %>%
dplyr::ungroup() %>%
dplyr::group_by(diff,motif_length)%>%
dplyr::mutate(mean_frac=mean(frac),
median_frac=median(frac)) %>%
dplyr::mutate(id=row_number(),
mean_frac=ifelse(id==1,round(mean_frac,digits = 2),NA)) %>%
dplyr::ungroup() %>%
dplyr::mutate( diff=sub("(.*)(_frac)","\\1",diff))
fig_2d <- ggplot(expand_frac,aes(x=diff,y=frac ,color=diff))+
geom_violin(width=1.1,size=0.2)+
geom_boxplot(width=0.08, color="black",fill="grey", alpha=0.2,outlier.shape = NA,size=0.2) +
geom_point(aes(x=diff,y=abs(mean_frac)),size=0.5,color="red") +
theme_cust +
ylab("Allele frequency") +
xlab("Variation to median allele")+
ggpubr::stat_compare_means(label = "p.signif",
label.y = 0.53 ,  label.x=1.35,
symnum.args = list(cutpoints = c(0,  0.001,  1),
symbols = c("****",   "ns")),
method = "wilcox.test" ) +
facet_grid(.~motif_length,scales="free") +
scale_color_manual(values=c("#E7B800", "#00AFBB")) +
theme(axis.text.x = element_blank(),
strip.text = element_blank(),
legend.position = "none") +
scale_y_continuous(expand = c(0, 0), limits = c(0, 0.6))
###### fig_2e ######
expansion_contractionS_di <- table_s1_poly %>%
dplyr::filter(!grepl("/",motif_geno)) %>%
dplyr::mutate(motif_geno=motif_geno_fwd ) %>%
dplyr::select(ref_STR ,expansion_score,contraction_score,motif_length,motif_geno) %>%
tidyr::gather(diff,score,-ref_STR,-motif_length,-motif_geno) %>%
dplyr::filter(motif_length==2) %>%
dplyr::mutate(diff=ifelse(score==0,"substitution",diff)) %>%
dplyr::group_by(motif_geno,diff,motif_length) %>%
dplyr::count()  %>%
dplyr::group_by(motif_geno) %>%
dplyr::mutate(count_motif=sum(n)) %>%
dplyr::mutate(frac=100*n/count_motif) %>%
dplyr::mutate(count_motif2=ifelse(diff=="substitution",count_motif,NA),
heading=ifelse(count_motif2==618,"The total number of di-STRs with each motif", NA)) %>%
dplyr::mutate(diff=sub("(.*)(_score)","\\1",diff))
fig_2e <- ggplot(expansion_contractionS_di,aes(x=motif_geno,y=frac,fill=factor(diff))) +
geom_bar(stat='identity', position = position_stack(reverse = TRUE)) +
theme_cust +
scale_fill_manual(values=c("#E7B800", "#00AFBB","gray69")) +
xlab("Motif")+
ylab("Percent of\nALT alleles (%)")  +
labs(fill="Mutations") +
geom_text(aes(label=count_motif2),y=105,size = 10*5/14) +
scale_y_continuous(breaks=c(0, 50, 100),limits = c(0,120) )+
geom_text(  aes(label=heading) ,y=117,size = 10*5/14  )
###### fig 2 #####
fig2ab <-  cowplot::plot_grid(fig_2a, fig_2b,
labels = c('', 'B'),
label_size = 12,
label_fontfamily="Helvetica",
axis = "tb",
nrow = 1)
fig2cd <-  cowplot::plot_grid(fig_2c,fig_2d,
labels = c('', 'D'),
rel_heights =  c(1.1,1 ),
label_size = 12,
label_fontfamily="Helvetica",
axis = "lr",
align = "v",
nrow = 2)
fig2 <-  cowplot::plot_grid(fig2ab, fig2cd,fig_2e,
labels = c('A', 'C' , "E"),
rel_heights =  c(1,2,1.2),
label_size = 12,
label_fontfamily="Helvetica",
axis = "lr",
nrow = 3)
ggsave(fig2, filename = paste( "../figures/Fig_2.svg",sep = ""), units = "mm",height = 180, width = 170)
ggsave(fig2, filename = paste( "../figures/Fig_2.pdf",sep = ""), units = "mm",height = 180, width = 170)
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/"))
library(tidyverse)
snvs_He <- data.table::fread("/Users/gaotian/OneDrive - Northwestern University/projects/manuscripts/STR/processed_data/Expected_Heterozygosity_swept_SNVs.csv")%>%
tidyr::separate(marker,into = c("Chr","start"),sep = "_") %>%
dplyr::mutate(start=as.numeric(start)/1e6,
type="SNVs") %>%
dplyr::filter(Chr != "MtDNA")
View(snvs_He)
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/"))
library(tidyverse)
theme_cust <- theme_bw() +
theme(plot.title = ggplot2::element_text(size=10,  color = "black"),
legend.text = ggplot2::element_text(size=10,  color = "black"),
legend.title =  ggplot2::element_text(size=10,  color = "black"),
axis.title =  ggplot2::element_text(size=10,  color = "black"),
axis.text =  ggplot2::element_text(size=10,  color = "black"),
strip.text = ggplot2::element_text(size=10, vjust = 1,  color = "black"),
strip.background = ggplot2::element_blank(),
panel.grid = ggplot2::element_blank(),
text = ggplot2::element_text(family="Helvetica"))
ancestry.colours <- c("gold2","plum4", "darkorange1",   "lightskyblue2",
"springgreen4", "lightpink2",  "deepskyblue4",
"yellow3",  "yellow4",
'black','red2', 'cornflowerblue', 'magenta', 'darkolivegreen4',
'indianred1', 'tan4', 'darkblue', 'yellowgreen', "tan1",
'darkgray', 'wheat4', '#DDAD4B', 'chartreuse','seagreen1',
'moccasin', 'mediumvioletred', 'cadetblue1',"darkolivegreen1" ,"#7CE3D8",
"gainsboro","#E69F00","#009E73", "#F0E442", "sienna4", "#0072B2",
"mediumpurple4","#D55E00", "burlywood3","gray51","#CC79A7","gray19", "firebrick")
period_size_color <- c("1"="gold2","2"="plum4","3"="darkorange1",
"4"= "lightskyblue2","5" = "springgreen4", "6" = "lightpink2" )
table_s1 <- data.table::fread("../processed_data/table_s1_refSTRs_pSTRs.txt")
table_s1_poly <- table_s1 %>%
dplyr::filter(pSTRs=="Yes")
###### fig_2a ######
bp_diff_BPD <- table_s1_poly %>%
dplyr::select(ref_STR,Chr,start,BPDIFFS) %>%
dplyr::arrange(Chr,start) %>%
splitstackshape::cSplit("BPDIFFS",",", direction = "long",sep = ",")
num_allele <- bp_diff_BPD %>% # fig_2a
dplyr::group_by(ref_STR) %>%
dplyr::count() %>%
dplyr::mutate(n=n+1)
fig_3a <- ggplot(num_allele,aes(n))   +
geom_histogram(color="black", fill="white",bins =21,size=0.2) +
theme_cust +
xlab("Number of alleles\nper pSTR") +
ylab("Number of pSTRs") +
scale_y_continuous(breaks=c(0, 3000, 1500), limits=c(0, 3000))+
scale_x_continuous(breaks=c(2,10,21) )  +
theme( axis.title.y = ggplot2::element_text(size=10,  color = "black", hjust = 0.2 ))
majorAF_ExpectedHe <- data.table::fread("../processed_data/table_s3_Expected_Heterozygosity.txt") %>%
dplyr::rename(af=allele_frequency,hets=He)
View(majorAF_ExpectedHe)
data_fig_3f <- majorAF_ExpectedHe %>%
dplyr::select(Chr,start,ref_STR,hets,n_st) %>%
dplyr::distinct()  %>%
dplyr::filter(Chr != "MtDNA")
View(data_fig_3f)
snvs_He <- data.table::fread("../processed_data/Expected_Heterozygosity_swept_SNVs.csv")%>%
tidyr::separate(marker,into = c("Chr","start"),sep = "_") %>%
dplyr::mutate(start=as.numeric(start)/1e6,
type="SNVs") %>%
dplyr::filter(Chr != "MtDNA")
View(snvs_He)
View(data_fig_3f)
View(majorAF_ExpectedHe)
majorAF_ExpectedHe <- data.table::fread("../processed_data/table_s3_Expected_Heterozygosity.txt")
majorAF_ExpectedHe <- data.table::fread("../processed_data/table_s3_Expected_Heterozygosity.txt") %>%
dplyr::mutate(start=start*1e6)
write.table(majorAF_ExpectedHe, paste("../processed_data/table_s3_Expected_Heterozygosity.txt",sep = ""), sep = "\t", row.names = F, quote = FALSE)
majorAF_ExpectedHe <- data.table::fread("../processed_data/table_s3_Expected_Heterozygosity.txt")
majorAF_ExpectedHe <- data.table::fread("../processed_data/table_s3_Expected_Heterozygosity.txt") %>%
dplyr::rename(af=allele_frequency,hets=He)
snvs_He <- data.table::fread("../processed_data/Expected_Heterozygosity_swept_SNVs.csv")
View(snvs_He)
snvs_He <- data.table::fread("../processed_data/Expected_Heterozygosity_swept_SNVs.csv") %>%
tidyr::separate(marker,into = c("Chr","start"),sep = "_") %>%
dplyr::mutate(type="SNVs") %>%
dplyr::filter(Chr != "MtDNA")
View(snvs_He)
snvs_He <- data.table::fread("../processed_data/Expected_Heterozygosity_swept_SNVs.csv") %>%
tidyr::separate(marker,into = c("Chr","start"),sep = "_") %>%
dplyr::mutate(type="SNVs") %>%
dplyr::rename(He=hets)
View(snvs_He)
snvs_He <- data.table::fread("../processed_data/Expected_Heterozygosity_swept_SNVs.csv") %>%
tidyr::separate(marker,into = c("Chr","start"),sep = "_") %>%
dplyr::mutate(n_st="Swept",type="SNVs") %>%
dplyr::rename(He=hets)
write.table(snvs_He, paste("../processed_data/Expected_Heterozygosity_swept_SNVs.txt",sep = ""), sep = "\t", row.names = F, quote = FALSE)
snvs_He <- data.table::fread("../processed_data/Expected_Heterozygosity_swept_SNVs.txt")
snvs_He <- data.table::fread("../processed_data/Expected_Heterozygosity_swept_SNVs.txt") %>%
dplyr::rename(hets=He)
snvs_He <- data.table::fread("../processed_data/Expected_Heterozygosity_swept_SNVs.txt") %>%
dplyr::rename(hets=He)
data_fig_3f <- majorAF_ExpectedHe %>%
dplyr::select(Chr,start,hets,type=n_st) %>%
dplyr::distinct()  %>%
dplyr::mutate(type=n_st)  %>%
dplyr::bind_rows(snvs_He) %>%
dplyr::filter(Chr != "MtDNA") %>%
dplyr::mutate(start=as.numeric(start)/1e6)
View(majorAF_ExpectedHe)
data_fig_3f <- majorAF_ExpectedHe %>%
dplyr::select(Chr,start,hets,n_st) %>%
dplyr::distinct()  %>%
dplyr::mutate(type=n_st)  %>%
dplyr::bind_rows(snvs_He) %>%
dplyr::filter(Chr != "MtDNA") %>%
dplyr::mutate(start=as.numeric(start)/1e6)
View(data_fig_3f)
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/"))
### load R packages####
library(tidyverse)
### ggplot theme ####
theme_cust <- theme_bw() +
theme(plot.title = ggplot2::element_text(size=10,  color = "black"),
legend.text = ggplot2::element_text(size=10,  color = "black"),
legend.title =  ggplot2::element_text(size=10,  color = "black"),
axis.title =  ggplot2::element_text(size=10,  color = "black"),
axis.text =  ggplot2::element_text(size=10,  color = "black"),
strip.text = ggplot2::element_text(size=10, vjust = 1,  color = "black"),
strip.background = ggplot2::element_blank(),
panel.grid = ggplot2::element_blank(),
text = ggplot2::element_text(family="Helvetica"))
ancestry.colours <- c("gold2","plum4", "darkorange1",   "lightskyblue2",
"springgreen4", "lightpink2",  "deepskyblue4",
"yellow3",  "yellow4",
'black','red2', 'cornflowerblue', 'magenta', 'darkolivegreen4',
'indianred1', 'tan4', 'darkblue', 'yellowgreen', "tan1",
'darkgray', 'wheat4', '#DDAD4B', 'chartreuse','seagreen1',
'moccasin', 'mediumvioletred', 'cadetblue1',"darkolivegreen1" ,"#7CE3D8",
"gainsboro","#E69F00","#009E73", "#F0E442", "sienna4", "#0072B2",
"mediumpurple4","#D55E00", "burlywood3","gray51","#CC79A7","gray19", "firebrick")
period_size_color <- c("1"="gold2","2"="plum4","3"="darkorange1",
"4"= "lightskyblue2","5" = "springgreen4", "6" = "lightpink2" )
#### func ####
fisher_enrich_func <- function(pt_deg){
sis <- pt_deg$sig_n
silp <- pt_deg$n - sis
fis <- pt_deg$sig_total - sis
filp <- pt_deg$total - pt_deg$sig_total - silp
ftp <- fisher.test(matrix(c(sis,silp,fis,filp), 2, 2), alternative='greater')
return(ftp$p.value)
}
table_s1 <- data.table::fread("../processed_data/table_s1_refSTRs_pSTRs.txt")
table_s1_poly <- table_s1 %>%
dplyr::filter(pSTRs=="Yes")
###### fig_2a ######
bp_diff_BPD <- table_s1_poly %>%
dplyr::select(ref_STR,Chr,start,BPDIFFS) %>%
dplyr::arrange(Chr,start) %>%
splitstackshape::cSplit("BPDIFFS",",", direction = "long",sep = ",")
############# Figure  3    ###############
#             popgenet                    #
##########################################
###### fig_3a ######
num_allele <- bp_diff_BPD %>% # fig_2a
dplyr::group_by(ref_STR) %>%
dplyr::count() %>%
dplyr::mutate(n=n+1)
fig_3a <- ggplot(num_allele,aes(n))   +
geom_histogram(color="black", fill="white",bins =21,size=0.2) +
theme_cust +
xlab("Number of alleles\nper pSTR") +
ylab("Number of pSTRs") +
scale_y_continuous(breaks=c(0, 3000, 1500), limits=c(0, 3000))+
scale_x_continuous(breaks=c(2,10,21) )  +
theme( axis.title.y = ggplot2::element_text(size=10,  color = "black", hjust = 0.2 ))
###### fig_3b ######
majorAF_ExpectedHe <- data.table::fread("../processed_data/table_s3_Expected_Heterozygosity.txt") %>%
dplyr::rename(af=allele_frequency,hets=He)
majorAF_data <- majorAF_ExpectedHe %>%
dplyr::group_by(ref_STR,n_st) %>%
dplyr::mutate( major_af=max(af)) %>%
dplyr::filter(af==major_af)
fig_3b <- ggplot()   +
ggplot2::stat_density(data=majorAF_data,aes(x=major_af,color=n_st ), geom="line",position = "identity",
size=0.8 ) +
scale_color_manual(values=c("#00AFBB", "#E7B800", "#FC4E07")) +
theme_cust +
theme(legend.position = c(.4,.6) ,
legend.spacing  = unit(0.1, 'cm'),
legend.margin=margin(1,1,1,1)) +
ylab("Density") +
xlab("Major\nallele frequency") +
scale_x_continuous(breaks=c(0, 0.5, 1),limits = c(0,1) )+
labs(color="Strains")
###### fig_3c ######
strain_ALT_frac <- data.table::fread("../processed_data/table_s4_strain_ALT_frac.txt")
fig_3c <- ggplot()+
geom_point(data=strain_ALT_frac,aes(x=alt_frac,y=hets_frac,color=sweep),size=0.5,alpha=0.8)+
theme_cust+
labs(x="Homozygous ALT\npSTRs in each strain (%)",
y= "Heterozygous pSTRs\nin each strain (%)") +
scale_color_manual(values = c("#E7B800", "#FC4E07")) +
theme( legend.background = element_rect(colour = 'gray79', fill = 'white', linetype='solid'),
legend.spacing  = unit(0.1, 'cm'),
legend.margin=margin(1,1,1,1),
plot.margin = unit(c(0, 2, 0, 5), "mm"),
legend.position="none")
###### fig_3d ######
pca_pSTR_SNV <- data.table::fread("../processed_data/table_s5_pca_pSTR_SNV.txt")
pca_pSTR <- pca_pSTR_SNV %>%
dplyr::filter(data=="pSTRs")
fig_3d <- ggplot(pca_pSTR, aes(x=PC1,y=PC2)) +
geom_point(aes(color=cluster ),size=1,alpha=0.8) +
theme_cust +
theme(legend.position="none")+
labs(x=paste0("PC1: ",unique(pca_pSTR$PC1_var_exp)[1],"%"),
y=paste0("PC2: ",unique(pca_pSTR$PC2_var_exp)[1],"%")) +
ggtitle("9,691 pSTRs") +
scale_color_manual(values=ancestry.colours)
###### fig_3e ######
pca_SNV <- pca_pSTR_SNV %>%
dplyr::filter(data=="SNVs")
fig_3e <- ggplot(pca_SNV, aes(x=PC1,y=PC2)) +
geom_point(aes(color=cluster ),size=1,alpha=0.8) +
theme_cust +
labs(x=paste0("PC1: ",unique(pca_SNV$PC1_var_exp)[1],"%"),
y=paste0("PC2: ",unique(pca_SNV$PC2_var_exp)[1],"%"),
color = "Sample locations") +
ggtitle("13,580 SNVs") +
scale_color_manual(values=ancestry.colours)
###### fig_3f ######
snvs_He <- data.table::fread("../processed_data/Expected_Heterozygosity_swept_SNVs.txt") %>%
dplyr::rename(hets=He)
data_fig_3f <- majorAF_ExpectedHe %>%
dplyr::select(Chr,start,hets,n_st) %>%
dplyr::distinct()  %>%
dplyr::mutate(type=n_st)  %>%
dplyr::bind_rows(snvs_He) %>%
dplyr::filter(Chr != "MtDNA") %>%
dplyr::mutate(start=as.numeric(start)/1e6)
fig_3f <- ggpubr::ggscatter(data_fig_3f,
x = "start", y = "hets",  point=FALSE, palette = c("#00AFBB", "#E7B800", "#FC4E07","gray69"),
add = "loess", conf.int = FALSE,color="type" ) +
labs(x= "Genomic position (Mb)",
y= expression(italic(H)[E])) +
facet_grid(.~Chr,scales="free")+
theme_cust +
theme( axis.text.x = element_blank(),
legend.position = "none",
panel.spacing = unit(0.2,"line"))
###### fig_3 ######
fig3abc <-  cowplot::plot_grid(fig_3a, fig_3b,fig_3c,
labels = c('', 'B','C'),
rel_widths =  c(0.9,0.9 , 1.2),
label_size = 12,
label_fontfamily="Helvetica",
axis = "tb",
align = "h",
nrow = 1)
fig3de <- cowplot::plot_grid(fig_3d,  fig_3e,
labels = c('', 'E'  ),
rel_widths = c( 1,1.75  ),
label_size = 12,
label_fontfamily="Helvetica",
nrow = 1)
fig3 <-  cowplot::plot_grid(fig3abc, fig3de, fig_3f,
labels = c('A' ,'D','F' ),
rel_heights =  c(1.2,1.5,1.1 ),
label_size = 12,
label_fontfamily="Helvetica",
align = "v",
nrow = 3)
ggsave(fig3, filename = paste( "../figures/Fig_3.jpg",sep = ""), units = "mm",height = 180, width = 170)
fig_3f <- ggpubr::ggscatter(data_fig_3f,
x = "start", y = "hets",  point=FALSE, palette = c("#00AFBB", "#E7B800","gray69", "#FC4E07"),
add = "loess", conf.int = FALSE,color="type" ) +
labs(x= "Genomic position (Mb)",
y= expression(italic(H)[E])) +
facet_grid(.~Chr,scales="free")+
theme_cust +
theme( axis.text.x = element_blank(),
legend.position = "none",
panel.spacing = unit(0.2,"line"))
fig3 <-  cowplot::plot_grid(fig3abc, fig3de, fig_3f,
labels = c('A' ,'D','F' ),
rel_heights =  c(1.2,1.5,1.1 ),
label_size = 12,
label_fontfamily="Helvetica",
align = "v",
nrow = 3)
ggsave(fig3, filename = paste( "../figures/Fig_3.jpg",sep = ""), units = "mm",height = 180, width = 170)
